# Label Flipping Attack on Ransomware Detection Models

This repository contains the official code and datasets for the research paper, "Label Flipping Attack on Ransomware Detection Models," submitted to *Neurocomputing*. Our work introduces and evaluates a targeted label flipping attack, termed "Center Attack," designed to undermine machine learning-based ransomware detection models.

**Authors:** Kazi Samiul Kader, Md. Shohrab Hossain
<br>
**Affiliation:** Bangladesh University of Engineering and Technology (BUET)

---

## Abstract

Ransomware poses a significant cybersecurity threat, prompting the use of machine learning (ML) for detection. However, ML models are vulnerable to adversarial attacks, including label flipping, where manipulated training labels degrade performance. This paper introduces and evaluates a label flipping attack heuristic designed to undermine ransomware detection models. Our approach, termed "Center Attack," employs a targeted strategy for selecting which labels to flip, focusing on instances within each class that are geometrically closest to their own class's center (centroid). This strategy aims to introduce strong contradictory signals within the core distribution of each class, potentially disrupting the learned decision boundary more effectively than random noise. We evaluate this attack against random label flipping across four distinct classifiers (Logistic Regression, SVM Linear, SVM RBF, Neural Network) using two ransomware datasets (PE Header features and RISS). Extensive experiments demonstrate that the proposed Center Attack generally exhibits a more detrimental effect on classification accuracy, F1-score, precision, recall, and AUC compared to random noise, particularly at higher noise intensities. This work highlights the vulnerability of ML-based ransomware detection to targeted label flipping attacks that exploit data distribution characteristics and underscores the need for robust defense mechanisms considering such threats.

---

## Repository Structure

This repository is organized as follows:

-   `PE-Dataset/`: Contains the "Ransomware PE Header Feature Dataset" used in our experiments.
    -   `Ransomware_headers.csv`: The raw dataset file.
-   `Research_Data_Neurocomp.ipynb`: A Jupyter Notebook containing all the Python code to reproduce the experiments. This includes:
    -   Data loading and preprocessing for both datasets.
    -   Implementation of the "Center Attack" and "Random Attack".
    -   Model training, hyperparameter tuning, and evaluation.
    -   Code for generating all figures and result tables from the paper.
-   `README.md`: This file, providing an overview and instructions.
-   `charts/`: (Generated by the notebook) This directory will contain the output plots from the experiments.
-   `results/`: (Generated by the notebook) This directory will contain the experiment results saved in JSON format.

---

## Datasets

We use two distinct ransomware detection datasets in our evaluation:

1.  **Ransomware PE Header Feature Dataset:**
    -   **Source:** [Moreira et al., 2023](https://doi.org/10.1016/j.cose.2023.103265) (Reference [22] in the paper).
    -   **Description:** Contains 2,157 samples (1,134 benign, 1,023 ransomware) with features extracted from the headers of Portable Executable (PE) files. This dataset is included in the `PE-Dataset/` directory.

2.  **RISS (Ransomware Identification Shared Source) Dataset:**
    -   **Source:** [Sgandurra et al., 2016](https://arxiv.org/abs/1609.03020) (Reference [23] in the paper).
    -   **Description:** Contains 1,524 samples (942 benign, 582 ransomware) with features derived from the dynamic analysis of malware behavior.
    -   **Note:** The notebook `Research_Data_Neurocomp.ipynb` will automatically clone the RISS dataset repository and preprocess the data.

---

## Requirements and Setup

To run the experiments, you will need a Python environment (Python 3.8+ recommended) with several scientific computing libraries.

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/KaziSamiul/center-attack.git
    cd center-attack
    ```

2.  **Install the required libraries:**
    You can install all dependencies using pip:
    ```bash
    pip install numpy pandas scikit-learn matplotlib seaborn joblib
    ```

---

## How to Reproduce the Results

All experiments can be reproduced by running the cells in the `Research_Data_Neurocomp.ipynb` notebook. It is recommended to use an environment like Jupyter Lab, Jupyter Notebook, or Google Colab.

1.  **Open the Notebook:** Launch your Jupyter environment and open `Research_Data_Neurocomp.ipynb`.

2.  **Select the Dataset:** In the main execution cell (titled **"#@title Main"**), you can choose which dataset to run the experiment on by setting the `dataset_choice` variable:
    ```python
    # Set to 'pe' for the PE Header dataset
    dataset_choice = 'pe'

    # Set to 'riss' for the RISS dataset
    # dataset_choice = 'riss'
    ```

3.  **Run the Experiment:** Execute the cells in the notebook sequentially.
    -   **Data Loading and Preprocessing:** The initial cells will load the chosen dataset, perform standardization, and handle any missing values. The RISS dataset will be downloaded automatically if it's not present.
    -   **Feature Selection:** The notebook first determines the optimal number of features to use for each dataset (800 for PE Header, 1000 for RISS) and saves a diagnostic plot.
    -   **Main Experiment Loop:** The `run_experiment` function will:
        -   Iterate through the four classifiers (Logistic Regression, SVM Linear, SVM RBF, MLP).
        -   Apply both the **Center Attack** and **Random Attack** at various noise intensities (from 0% to 30%).
        -   Train and evaluate the models over 5 repeated runs for statistical robustness.
        -   Save the final results to a timestamped JSON file in the `results/` directory.
    -   **Note:** The full experiment can be computationally intensive and may take a significant amount of time to complete.

4.  **Generate Plots:**
    -   After the experiment is complete and the results are saved, you can run the final cells of the notebook.
    -   These cells load the saved JSON files and use the `plot_results_compact_both` function to generate the figures presented in the paper, saving them to the `charts/` directory.

---

## Citation

If you use the code, datasets, or findings from this work in your research, please cite our paper.
